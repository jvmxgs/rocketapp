!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class s{constructor(){this.calculateSize()}calculateSize(){screen.width<.8*screen.height?(this.width=screen.width,this.height=screen.height):(this.width=.8*screen.height,this.height=screen.height)}getRelativePositionX(t){return this.width*(t/100)}getRelativePositionY(t){return this.height*(t/100)}calculateScale(){}}class r{constructor(t){this.scene=t,this.display=new s,this.cursors=t.input.keyboard.createCursorKeys()}chechWhatHalf(){this.firstHalf=this.scene.input.pointer1.x<this.display.getRelativePositionX(50)}keyLeft(){return Phaser.Input.Keyboard.JustDown(this.cursors.left)}keyRight(){return Phaser.Input.Keyboard.JustDown(this.cursors.right)}touchedDown(){return this.chechWhatHalf(),this.scene.input.pointer1.justDown}}class a{constructor(t,e,i){var s=t.cache.json.get("rocketShape");this.sprite=t.matter.add.sprite(0,0,"rocket",0,{shape:s.rocket}),this.tailfire=t.matter.add.sprite(0,0,"tailfire",1),this.sprite.setFixedRotation().setPosition(e,i),this.tailfire.setExistingBody(this.sprite.body.parts[1]).setFixedRotation().setPosition(this.sprite.body.parts[1].position.x,this.sprite.body.parts[1].position.y+this.tailfire.height/4),this.moveAngle=0,this.createAnimations(t),this.tailfire.anims.load("tailfiring"),this.tailfire.anims.play("tailfiring"),this.sprite.anims.load("rollingleft"),this.controls=new r(t)}createAnimations(t){t.anims.create({key:"tailfiring",frames:t.anims.generateFrameNumbers("tailfire",{start:1,end:2}),frameRate:25,yoyo:!0,repeat:-1}),t.anims.create({key:"rollingleft",frames:t.anims.generateFrameNumbers("rocket",{frames:[0,1,2]}),frameRate:15,yoyo:!0}),t.anims.create({key:"rollingright",frames:t.anims.generateFrameNumbers("rocket",{frames:[0,3,4]}),frameRate:15,yoyo:!0})}turnOnEngine(t){this.sprite.setVelocityY(Math.sin(this.sprite.body.angle-Math.PI/2)*t),this.sprite.setVelocityX(Math.cos(this.sprite.body.angle-Math.PI/2)*t)}moveToSide(t){this.sprite.angle<30&&this.sprite.angle>-30&&(this.moveAngle=t)}updateAngle(){0!=this.moveAngle?this.moveAngle>0?(this.sprite.angle+=1,this.moveAngle-=1,this.sprite.applyForce({x:.03,y:0})):(this.sprite.angle-=1,this.moveAngle+=1,this.sprite.applyForce({x:-.03,y:0})):this.sprite.angle>2?this.sprite.angle-=2:this.sprite.angle<-2?this.sprite.angle+=2:this.sprite.angle=0}update(t){(this.controls.keyLeft()||this.controls.touchedDown()&&this.controls.firstHalf)&&(this.moveToSide(-20),this.sprite.anims.play("rollingleft")),(this.controls.keyRight()||this.controls.touchedDown()&&!this.controls.firstHalf)&&(this.moveToSide(20),this.sprite.anims.play("rollingright")),this.updateAngle()}}class n{constructor(t){this.sprite=t.add.image(10,10,"fuel"),this.sprite.frame.setTrim(240,39,10,0,250,39),this.sprite.frame.updateUVs(),this.sprite.setOrigin(0),this.sprite.setScrollFactor(0)}}class o{constructor(t){this.tilemap=t.make.tilemap({key:"tilemap"});const e=this.tilemap.addTilesetImage("wall"),i=this.tilemap.createDynamicLayer("capa1",e,0,0);i.setCollisionByProperty({collide:!0}),t.matter.world.convertTilemapLayer(i),this.spawnPoint=this.tilemap.findObject("capaobj",t=>"SpawnPoint"===t.name)}}class h{constructor(t,e,i){this.camera=t.cameras.main,this.camera.startFollow(i),this.camera.setBounds(0,0,e.widthInPixels,e.heightInPixels),t.matter.world.setBounds(0,0,e.widthInPixels,e.heightInPixels),this.camera.setRoundPixels(!0),this.yOffset=0}fixYOffset(){this.yOffset<300&&(this.yOffset+=3,this.camera.setFollowOffset(0,this.yOffset))}}class l extends Phaser.Scene{constructor(){super({key:"mainScene"})}create(){this.map1=new o(this),this.rocket=new a(this,this.map1.spawnPoint.x,this.map1.spawnPoint.y),this.fuel=new n(this,this.map1.spawnPoint.x,this.map1.spawnPoint.y),this.camera=new h(this,this.map1.tilemap,this.rocket.sprite)}update(){this.camera.fixYOffset(),this.rocket.turnOnEngine(20),this.rocket.update(this)}}class c extends Phaser.GameObjects.Sprite{constructor(t,e,i,s,r){super(t,e,i,s,r),t.add.existing(this),this.makeInteractive()}makeInteractive(){this.setInteractive(),this.on("pointerup",function(t){this.setFrame(1)}),this.on("pointerdown",function(t){this.setFrame(2),this.click()}),this.on("pointerover",function(t){this.setFrame(1)}),this.on("pointerout",function(t){this.setFrame(0)})}}class p extends Phaser.Scene{constructor(){super({key:"menuScene"})}create(){let t=new s;this.boton=new c(this,t.getRelativePositionX(50),t.getRelativePositionY(50),"buttonplay",0),this.boton.click=()=>{this.scene.add("mainScene",new l),this.scene.start("mainScene")}}}class d extends Phaser.Scene{constructor(){super({key:"Boot",active:!0})}preload(){var t=this.add.graphics(),e=this.add.graphics();e.fillStyle(2236962,.8),e.fillRect(10,200,220,50),this.load.on("progress",function(e){t.clear(),t.fillStyle(16777215,1),t.fillRect(20,210,200*e,30)}),this.load.on("fileprogress",function(t){}),this.load.on("complete",()=>{t.destroy(),e.destroy(),this.scene.start("menuScene")}),this.load.spritesheet("buttonplay","assets/sprites/buttonplay.png",{frameWidth:64,frameHeight:64,endFrame:3}),this.load.spritesheet("rocket","./assets/sprites/rocket.png",{frameWidth:60,frameHeight:120}),this.load.spritesheet("tailfire","./assets/sprites/tailfire.png",{frameWidth:32,frameHeight:64}),this.load.image("fuel","./assets/sprites/fuel.png"),this.load.image("blocks","./assets/sprites/cloud.png"),this.load.image("wall","./assets/sprites/wall.png"),this.load.tilemapTiledJSON("tilemap","./assets/maps/tilemap.json"),this.load.json("rocketShape","./assets/sprites/rocket.json")}}var u={initialize:function(){document.addEventListener("deviceready",this.onDeviceReady.bind(this),!1)},onDeviceReady:function(){let t=new s;var e={type:Phaser.AUTO,parent:"rocketGame",width:t.width,height:t.height,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},backgroundColor:"#000",physics:{default:"matter",matter:{gravity:{y:9.8},debug:!1}},scene:[d,p]};new Phaser.Game(e)}};console.log("hecho"),u.initialize()}]);